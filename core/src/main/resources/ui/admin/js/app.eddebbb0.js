(function(e){function t(t){for(var a,i,o=t[0],l=t[1],d=t[2],u=0,p=[];u<o.length;u++)i=o[u],s[i]&&p.push(s[i][0]),s[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(t);while(p.length)p.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==s[l]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},s={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/jemo/admin/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),s=n("28dd"),r=n("bb71");n("da64");a["a"].use(r["a"],{iconfont:"md"});var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("navbar"),n("v-content",{staticClass:"mx-4 mb-4"},[n("keep-alive",[n("router-view")],1)],1)],1)},o=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-toolbar",{staticClass:"indigo",attrs:{app:"",dark:""}},[n("v-toolbar-title",{staticClass:"headline text-uppercase"},[n("span",[e._v("Eclipse Jemo")]),n("span",{staticClass:"font-weight-light mx-2"},[e._v("Admin UI")])]),n("v-spacer"),n("v-btn",{attrs:{flat:"",href:"https://www.eclipse.org/jemo/",target:"_blank"}},[n("span",{staticClass:"mr-8"},[e._v("Project page")])])],1)},d=[],c=n("2877"),u=n("6544"),p=n.n(u),h=n("8336"),v=n("9910"),g=n("71d9"),m=n("2a7f"),f={},b=Object(c["a"])(f,l,d,!1,null,null,null),_=b.exports;p()(b,{VBtn:h["a"],VSpacer:v["a"],VToolbar:g["a"],VToolbarTitle:m["a"]});var x={name:"App",components:{Navbar:_}},y=x,w=n("7496"),k=n("549c"),D=Object(c["a"])(y,i,o,!1,null,null,null),C=D.exports;p()(D,{VApp:w["a"],VContent:k["a"]});var V=n("8c4f"),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isAuthorised?n("div",[n("v-spacer"),n("v-container",{attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-card",{staticClass:"text-xs-left ma-3",attrs:{flat:""}},[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("h3",{staticClass:"headline mb-0"},[e._v("Admin Panel")])])]),n("v-card-text",[e._v("\n                Monitor the plugins that are currently deployed. You can de-activate and re-active plugin versions\n                or even delete (undeploy) them.\n          ")]),n("v-card-actions",[n("v-btn",{staticClass:"mx-2",attrs:{to:{name:"plugins",params:{headers:this.headers}},color:"primary"}},[e._v("\n                    Admin Panel\n            ")])],1)],1),n("v-card",{staticClass:"text-xs-left ma-3",attrs:{flat:""}},[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("h3",{staticClass:"headline mb-0"},[e._v("CI/CD")])])]),n("v-card-text",[e._v("\n              Deploy Jemo plugins by pointing to a github repository.\n              You need to have "),n("a",{attrs:{href:"https://git-scm.com/",target:"_blank"}},[e._v("git")]),e._v("\n              and "),n("a",{attrs:{href:"https://maven.apache.org/",target:"_blank"}},[e._v("mvn")]),e._v(" installed and on your Path to use this functionality.\n              For an example of a Jemo plugin see the "),n("a",{attrs:{href:"https://github.com/eclipse/jemo/tree/master/demos/jemo-trader-app",target:"_blank"}},[e._v("jemo-trader-app")]),e._v(".\n            ")]),n("v-card-actions",[n("v-btn",{staticClass:"mx-2",attrs:{to:{name:"cicd",params:{headers:this.headers}},color:"secondary"}},[e._v("\n                    CI/CD\n                ")])],1)],1)],1)],1)],1):n("v-form",[n("v-container",[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[n("v-text-field",{attrs:{label:"Jemo username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),n("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[n("v-text-field",{attrs:{label:"Jemo password",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),n("v-btn",{staticClass:"mx-4",attrs:{color:"primary"},on:{click:e.authorise}},[e._v("Submit")])],1)],1)],1)],1)},I=[],T={data:function(){return{isAuthorised:!1,username:"system.administrator@jemo.eclipse.org",password:null,headers:null}},methods:{authorise:function(){var e=this;this.headers={Authorization:"Basic "+window.btoa(this.username+":"+this.password)},this.$http.post("auth",{},{headers:this.headers}).then(function(t){console.log(t),e.isAuthorised=!0},function(e){console.log(e),alert(e.data?e.data:"Wrong username or password.")})}}},A=T,j=n("b0af"),S=n("99d9"),O=n("12b2"),$=n("a523"),B=n("0e8f"),F=n("4bd4"),R=n("a722"),E=n("2677"),J=Object(c["a"])(A,P,I,!1,null,null,null),M=J.exports;p()(J,{VBtn:h["a"],VCard:j["a"],VCardActions:S["a"],VCardText:S["b"],VCardTitle:O["a"],VContainer:$["a"],VFlex:B["a"],VForm:F["a"],VLayout:R["a"],VSpacer:v["a"],VTextField:E["a"]});var U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-spacer"),n("div",{staticClass:"d-flex justify-between align-center mb-3"},[n("v-btn",{attrs:{color:"primary"},on:{click:e.getPlugins}},[e._v("Refresh")]),n("v-btn",{attrs:{color:"secondary"},on:{click:e.expandAll}},[e._v("Expand All")]),n("v-btn",{attrs:{color:"green"},on:{click:e.colapseAll}},[e._v("Collapse All")])],1),e.plugins&&e.plugins.length>0?n("div",[n("h4",[e._v("Running Plugins")]),n("br")]):e._e(),n("v-expansion-panel",{attrs:{expand:""},model:{value:e.expand,callback:function(t){e.expand=t},expression:"expand"}},e._l(e.plugins,function(t,a){return n("v-expansion-panel-content",{key:a,scopedSlots:e._u([{key:"header",fn:function(){return[n("div",[n("strong",[e._v("id:")]),e._v(" "+e._s(t.pluginInfo.id))]),n("div",[n("strong",[e._v("name:")]),e._v(" "+e._s(t.pluginInfo.name))]),n("div",[n("strong",[e._v("version:")]),e._v(" "+e._s(t.pluginInfo.version))]),n("v-btn",{attrs:{loading:e.loading[t.pluginInfo.id+"-"+t.pluginInfo.version+"-act"],color:"primary",flat:""},on:{click:function(n){return e.changePluginVersionStatus(a,t.pluginInfo.id,t.pluginInfo.version,t.metaData.enabled)}}},[e._v(e._s(t.metaData.enabled?"Deactivate":"Activate")+"\n                ")]),n("v-btn",{attrs:{loading:e.loading[t.pluginInfo.id+"-"+t.pluginInfo.version+"-del"],color:"red",flat:""},on:{click:function(n){return e.alertForDeletion(t,a)}}},[e._v("Delete\n                ")])]},proxy:!0}],null,!0)},[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:[{text:"Endpoints",align:"left",sortable:!1,value:"endpoint"}],items:Object.keys(t.metaData.endpoints),"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(a){return[n("td",[n("strong",[e._v("class: ")]),e._v(e._s(a.item)+" - "),n("strong",[e._v("endpoint: ")]),e._v(e._s(t.metaData.endpoints[a.item])+"\n                    ")]),n("td",[n("strong",[e._v("avg response time: ")]),e._v(e._s(e.avg(t.metaData.stats[a.item])))])]}}],null,!0)}),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:[{text:"Batches",align:"left",sortable:!1,value:"batch"}],items:t.metaData.batches,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(a){return[n("td",[n("strong",[e._v("class: ")]),e._v(e._s(a.item))]),n("td",[n("strong",[e._v("avg response time: ")]),e._v(e._s(e.avg(t.metaData.stats[a.item])))])]}}],null,!0)}),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:[{text:"Events",align:"left",sortable:!1,value:"event"}],items:t.metaData.events,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(a){return[n("td",[n("strong",[e._v("class: ")]),e._v(e._s(a.item))]),n("td",[n("strong",[e._v("avg response time: ")]),e._v(e._s(e.avg(t.metaData.stats[a.item])))])]}}],null,!0)}),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:[{text:"Fixed Processes",align:"left",sortable:!1,value:"event"}],items:t.metaData.fixed,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[n("strong",[e._v("class: ")]),e._v(e._s(t.item))])]}}],null,!0)})],1)}),1),n("v-spacer"),n("br"),n("br"),e.pluginsPendingDeployment&&e.pluginsPendingDeployment.length>0?n("div",[n("h4",[e._v("Deployment History")]),n("br"),n("v-expansion-panel",{attrs:{expand:""},model:{value:e.expandPending,callback:function(t){e.expandPending=t},expression:"expandPending"}},e._l(e.pluginsPendingDeployment,function(t,a){return n("v-expansion-panel-content",{key:a,scopedSlots:e._u([{key:"header",fn:function(){return[n("div",[n("strong",[e._v("id:")]),e._v(" "+e._s(t.pluginId))]),n("div",[n("strong",[e._v("version:")]),e._v(" "+e._s(t.version))]),n("div",[n("strong",[e._v("name:")]),e._v(" "+e._s(t.name))]),n("div",[n("strong",[e._v("time:")]),e._v(" "+e._s(t.timestamp))]),n("div",[n("strong",[e._v("repoUrl:")]),e._v(" "+e._s(t.repoUrl))]),n("div",[n("strong",[e._v("branch:")]),e._v(" "+e._s(t.branch))]),n("div",[n("strong",[e._v("subDir:")]),e._v(" "+e._s(""===t.subDir?"-":t.subDir))]),t.success?n("v-icon",{attrs:{color:"teal"}},[e._v("done")]):n("v-icon",{attrs:{color:"error"}},[e._v("error")])]},proxy:!0}],null,!0)},[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:[{text:"Logs",align:"left",sortable:!1,value:"batch"}],items:Array.of(t.logs),"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[n("pre",[e._v(e._s(t.item))])])]}}],null,!0)})],1)}),1)],1):e._e(),n("v-dialog",{staticClass:"mx-1",attrs:{persistent:"","max-width":"400px"},model:{value:e.deleteConfirmationDialog,callback:function(t){e.deleteConfirmationDialog=t},expression:"deleteConfirmationDialog"}},[n("v-card",[n("v-card-text",[e._v("\n                Are you sure you want to delete this plugin?\n            ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:e.deletePluginVersion}},[e._v("OK\n                ")]),n("v-btn",{attrs:{color:"error",flat:""},on:{click:function(t){e.deleteConfirmationDialog=!1}}},[e._v("Cancel\n                ")])],1)],1)],1)],1)},z=[],L=(n("ac6a"),n("75fc")),W=(n("7f7f"),{data:function(){return{expand:[],expandPending:[],plugins:null,headers:this.$route.params.headers,loading:{},pluginsPendingDeployment:[],deleteConfirmationDialog:!1,pluginToDelete:null}},watch:{$route:function(e){"plugins"===e.name&&this.getPlugins()}},created:function(){this.getPlugins()},methods:{getPlugins:function(){var e=this;this.$http.get("plugins",{headers:this.headers}).then(function(t){console.log(t),e.plugins=t.data},function(e){console.log(e)}),this.pollForPendingDeployments()},pollForPendingDeployments:function(){var e=this;this.$http.get("cicd/result",{headers:this.headers}).then(function(t){console.log(t),e.pluginsPendingDeployment=t.data},function(e){console.log(e),alert(e.data?e.data:"Wrong username or password.")})},expandAll:function(){this.expand=Object(L["a"])(Array(this.plugins.length).keys()).map(function(){return!0}),this.expandPending=Object(L["a"])(Array(this.pluginsPendingDeployment.length).keys()).map(function(){return!0})},colapseAll:function(){this.expand=[],this.expandPending=[]},changePluginVersionStatus:function(e,t,n,a){var s=this;this.expand[e]=!this.expand[e];var r=t+"-"+n+"-act";this.loading[r]=!0;var i={enabled:!a};this.$http.patch("plugins/"+t+"/"+n,i,{headers:this.headers}).then(function(e){s.loading[r]=!1,console.log(e),200===e.status&&(s.plugins=s.plugins.map(function(t){return t.metaData.id===e.data.metaData.id?e.data:t}))},function(e){s.loading[r]=!1,alert(e.data),console.log(e)})},alertForDeletion:function(e,t){this.expand[t]=!this.expand[t],this.pluginToDelete={plugin:e,index:t},this.deleteConfirmationDialog=!0},deletePluginVersion:function(){var e=this;this.expand[n]=!this.expand[n],this.deleteConfirmationDialog=!1;var t=this.pluginToDelete.plugin,n=this.pluginToDelete.index;this.pluginToDelete=null;var a=t.pluginInfo.id+"-"+t.pluginInfo.version+"-del";this.loading[a]=!0,this.$http.delete("plugins/"+t.pluginInfo.id+"/"+t.pluginInfo.version,{headers:this.headers}).then(function(t){e.loading[a]=!1,console.log(t),204===t.status&&e.plugins.splice(n,1)},function(t){e.loading[a]=!1,alert(t.data)})},avg:function(e){return e?(e.totalTime/e.samples).toFixed(2):0}}}),N=W,Y=n("8fea"),q=n("169a"),G=n("cd55"),H=n("49e2"),K=n("132d"),Q=Object(c["a"])(N,U,z,!1,null,null,null),X=Q.exports;p()(Q,{VBtn:h["a"],VCard:j["a"],VCardActions:S["a"],VCardText:S["b"],VDataTable:Y["a"],VDialog:q["a"],VExpansionPanel:G["a"],VExpansionPanelContent:H["a"],VIcon:K["a"],VSpacer:v["a"]});var Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-container",{attrs:{"grid-list-md":""}},[e.response||e.error?e._e():n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:"",sm10:"",md9:"",lg7:""}},[n("v-card",{staticClass:"text-xs-center ma-3",attrs:{flat:""}},[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("h3",{staticClass:"headline mb-0"},[e._v("\n                                Select a Github repository with the code\n                                of a Jemo plugin to deploy from.\n                            ")])])]),n("v-card-text",[n("v-form",{ref:"form",staticClass:"mx-4"},[n("v-text-field",{attrs:{label:"username*"},on:{focusout:e.getRepositories},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("v-text-field",{attrs:{label:"password**"},on:{focusout:e.getRepositories},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e.repositories.length>0?n("v-select",{attrs:{items:e.repositories,label:"repositories*"},on:{change:e.getBranches},model:{value:e.selectedRepository,callback:function(t){e.selectedRepository=t},expression:"selectedRepository"}}):e._e(),e.branches.length>0?n("v-select",{attrs:{items:e.branches,label:"branches"},model:{value:e.selectedBranch,callback:function(t){e.selectedBranch=t},expression:"selectedBranch"}}):e._e(),e.branches.length>0?n("v-text-field",{attrs:{label:"sub-directory"},model:{value:e.subDirectory,callback:function(t){e.subDirectory=t},expression:"subDirectory"}}):e._e(),e.selectedRepository?n("v-text-field",{attrs:{label:"pluginId***"},model:{value:e.pluginId,callback:function(t){e.pluginId=t},expression:"pluginId"}}):e._e(),e.branches.length>0?n("v-switch",{attrs:{color:"indigo",label:"Skip tests","hide-details":""},model:{value:e.skipTests,callback:function(t){e.skipTests=t},expression:"skipTests"}}):e._e(),n("v-card-text",[e._v("(*) Mandatory field")]),n("v-card-text",[e._v("(**) If the github account has 2FA enabled, you need to provide the\n                                "),n("a",{attrs:{href:"https://github.com/settings/tokens/new",target:"_blank"}},[e._v("personal auth token")]),e._v(",\n                                rather than the password.")]),e.selectedRepository?n("v-card-text",[e._v("(***) Unique App identifier. For apps deployed\n                                for the first time use the displayed value.\n                                Otherwise, use the same id as in the first time.\n                            ")]):e._e()],1)],1),n("v-card-actions",[n("v-btn",{attrs:{loading:e.loading,disabled:!e.validForm,color:"primary"},on:{click:e.deploy}},[e._v("\n                            Submit\n                        ")])],1)],1)],1)],1)],1),e.response?n("div",[n("h3",[e._v(e._s(e.response.msg))]),n("br"),e._v("\n        The following logs were produced:\n        "),n("br"),n("br"),n("pre",[e._v(e._s(e.response.logs))])]):e._e(),e.error?n("div",[n("h3",[e._v(e._s(e.error.msg))]),e.error.logs?n("div",[n("br"),e._v("\n            The following logs were produced:\n            "),n("br"),n("br"),n("pre",[e._v(e._s(e.error.logs))])]):e._e()]):e._e()],1)},ee=[],te=n("f499"),ne=n.n(te),ae={data:function(){return{headers:this.$route.params.headers,service:"git",username:null,password:null,prevUsername:null,prevPassword:null,repositories:[],selectedRepository:null,branches:[],selectedBranch:null,subDirectory:"",skipTests:!1,pluginId:null,loading:!1,response:null,error:null}},computed:{validForm:function(){return this.username&&this.selectedRepository&&this.pluginId}},watch:{$route:function(e){"cicd"===e.name&&(this.loading=!1,this.response=null,this.error=null)}},created:function(){this.getPlugins()},methods:{getPlugins:function(){var e=this;this.$http.get("plugins",{headers:this.headers}).then(function(t){console.log(t);var n=t.data.map(function(e){return e.pluginInfo.id});e.pluginId=n.length>0?Math.max.apply(Math,Object(L["a"])(n))+1:2},function(e){console.log(e),alert(e.data?e.data:"Wrong username or password.")})},clear:function(){this.repositories=[],this.branches=[],this.selectedRepository=null,this.selectedBranch=null,this.subDirectory=""},getRepositories:function(){var e=this;if(this.prevUsername!==this.username||this.prevPassword!==this.password){this.prevPassword=this.password,this.prevUsername=this.username,this.clear();var t=this.password?{Authorization:"Basic "+window.btoa(this.username+":"+this.password)}:{};this.$http.get("https://api.github.com/users/"+this.username+"/repos",{headers:t}).then(function(t){e.repositories=t.data.map(function(e){return e.name}),console.log(t)},function(e){console.log(e),alert("No gihub repository found for this username/password.\n\n"+ne()(e.data))})}},getBranches:function(){var e=this,t=this.password?{Authorization:"Basic "+window.btoa(this.username+":"+this.password)}:{};this.$http.get("https://api.github.com/repos/"+this.username+"/"+this.selectedRepository+"/branches",{headers:t}).then(function(t){e.branches=t.data.map(function(e){return e.name}),console.log(t)},function(e){console.log(e)})},deploy:function(){var e=this;this.loading=!0,this.response=null,this.error=null;var t={service:this.service,repoUrl:"https://github.com/"+this.username+"/"+this.selectedRepository+".git",branch:this.selectedBranch?this.selectedBranch:"master",subDir:this.subDirectory,pluginId:this.pluginId,skipTests:this.skipTests};this.$http.post("cicd",t,{headers:this.headers}).then(function(t){console.log(t),e.loading=!1,e.response=t.data,e.$router.push({name:"plugins",params:{headers:e.headers}})},function(t){t.data.logs?(console.log(t),e.error=t.data):alert(t.data.msg),e.loading=!1})}}},se=ae,re=n("b56d"),ie=n("b73d"),oe=Object(c["a"])(se,Z,ee,!1,null,null,null),le=oe.exports;p()(oe,{VBtn:h["a"],VCard:j["a"],VCardActions:S["a"],VCardText:S["b"],VCardTitle:O["a"],VContainer:$["a"],VFlex:B["a"],VForm:F["a"],VLayout:R["a"],VSelect:re["a"],VSwitch:ie["a"],VTextField:E["a"]}),a["a"].use(V["a"]);var de=new V["a"]({routes:[{path:"/",name:"home",component:M},{path:"/plugins",name:"plugins",component:X},{path:"/cicd",name:"cicd",component:le},{path:"*",redirect:{name:"home"}}]});a["a"].config.productionTip=!1,a["a"].use(s["a"]),a["a"].http.options.root="/jemo/admin",new a["a"]({router:de,render:function(e){return e(C)}}).$mount("#app")}});
//# sourceMappingURL=app.eddebbb0.js.map